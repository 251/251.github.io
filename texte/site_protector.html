<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de"><head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta http-equiv="Language" content="de" />
<link rel="stylesheet" type="text/css" href="/css/basis.css" />

<title>Franks Netzseite</title>

</head><body>

<div id="main">

<div id="zitat">
<q>Noch nie hat eine Religion, weder mittelbar noch unmittelbar, weder als Dogma noch als Gleichnis, eine Wahrheit enthalten.</q>
</div>

<h2>Willkommen auf meiner Netzseite</h2>

<p>
Wer auf diesen Seiten tiefschürfende Erkenntnisse, Weltverbesserungsvorschläge oder doch wieder nur Bilder siebenachtelnackter Kopulationszielpersonen sucht, der wird leider enttäuscht werden. Meine Seite ist momentan nur dazu da, mir einen Teil meiner Verweisliste virtuell hinterherzutragen. Nein, nicht wie Mutti früher die Stullenbüchse in die Schule zur Freude der gesamten Klasse, sondern viel cooler (Das sagte man früher so.).<br />
Sollten Sie zufällig ähnliche <del>Männerhobbys</del> <ins>sinnvolle Interessen</ins> haben, sich zum Beispiel für Geschichte, Rechentechnik, Photographie, lange Sätze oder alte Kraftfahrzeuge interessieren, und hier den ein oder anderen Verweis finden, der dazu führt, daß Sie den Abend vor dem Rechner und nicht mit Ihrer besseren Hälfte verbringen, so tut es mir Leid. Natürlich war das alles überhaupt nicht so gewollt.
</p>

<div id="container">
<div id="menu">
	<ul>
		<li class="istop"><a href="/index.html">Auswahl</a></li>
		<li><a href="/verweise/buecher.html">Bücher</a></li>
		<li><a href="/verweise/geschichte.html">Geschichte</a></li>
		<li><a href="/verweise/kfz.html">Kraftfahrzeuge</a></li>
		<li><a href="/verweise/software.html">Software</a></li>
		<li><a href="/verweise/sonstiges.html">Sonstiges</a></li>
		<li><a href="/verweise/studium.html">Studium</a></li>
	</ul>
</div>

<div class="content">

<h2>JavaScript-Zugangsschutz für Spaßvögel</h2>
<p>In den Weiten des Netzes stößt man immer wieder auf kreative Seitenbetreiber,
die ihre Netzseiten mit Hilfe von <abbr title="JavaScript">JS</abbr>-Skripten
gegen fremden Zugriff schützen wollen. Die meisten Lösungen fallen unter
&quot;security by obscurity&quot;, haben also ein Sicherheitsniveau knapp über
dem direkten Anzeigen der &quot;versteckten&quot; Inhalte, aber weit unter dem
eines Kaugummiautomaten.</p>

<p>Im einfachsten Fall steht das Paßwort oder die gesuchte Seite
<a href="http://www.angelfire.com/realm2/password_protection/">direkt im
Quelltext</a> oder es hilft ein <code>alert();</code> an der richtigen Stelle, um
Sicherheitvorgaukelfunktionen zu umgehen. Nur in wenigen Fällen muß man wirklich
nachdenken und Algorithmen nachvollziehen, um an die gewünschten Daten zu
gelangen. Schade eigentlich.</p>

<p>Am häufigsten wird aus dem Paßwort der Name der &quot;versteckten&quot; Seite
generiert. Wobei &quot;generiert&quot; oftmals stark übertrieben ist und das
<a href="http://nopassweb.tripod.com/NoPass.html">Paßwort einfach
als Seitenadresse</a> wiederverwendet wird. Es muß wohl am proprietären
JScript-Encode, zu dem es natürlich ein
<a href="http://www.greymagic.com/security/tools/decoder/">passendes Decode</a>
gibt, liegen, daß es zu den sichersten Varianten gehört:</p>
<blockquote cite="http://www.hotscripts.com./Detailed/17809.html">
<p><b>Description:</b> NoPass is a password security system that can be used to
protect web pages and files. As it is impossible to obtain the password from the
source code, NoPass is very secure for a JavaScript of its kind. Possibly the
most secure JavaScript password protection available. [...]</p>
</blockquote>
<p>Mit ein paar unnützen
Sicherheitvorgaukel- bzw. Quelltextfüllfunktionen kann man
<a href="http://club.coolmaps.com/components_demo/ProtectIt/protectit.html">solch
einen Quatsch</a> auch für echtes(!) Geld (ver-)kaufen.</p>

<p>Vor kurzem<sup>1</sup> bin ich allerdings auf ein besonders niedliches
Exemplar (Site Protector 5.x)<sup>2</sup> gestoßen<sup>3</sup>, das auf der
<a href="http://www.apollon.de/">Autorenseite</a> mit:</p>
<blockquote cite="http://www.apollon.de/Components/Script/sp_faq.html">
<h3>How well are the pages protected?</h3>

<p>They aren't completely protected because it's only client-side
javaScript-Protection. But it's still very well protected in the sense that
everything is encrypted and the password isn't included directly. Many people
have tried to break this protection - all have failed :-)</p>
</blockquote>
<p>beworben wird. Der Smiley deutet schon in die richtige Richtung.</p>

<p>Netterweise gibt es gleich eine
<a href="http://www.apollon.de/Components/demos/sp_demo.html">Demoseite</a>, um
sich den Quelltext anzusehen:</p>
<pre style="overflow:auto">
&lt;SCRIPT LANGUAGE=&quot;JavaScript&quot;&gt;&lt;!--
var sp_trys = 3;var sp_alpha=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789-:/._abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;;var sp_a1=new Array(); var sp_a2=new Array();
sp_a1[0]=11; sp_a2[0]=&quot;_h.h_gDxnypwfwuB.mfvpB.ysxundCfm_quvm&quot;;
function sp() {var pass=&quot;&quot;;var revisit=false;if (! revisit) {pass = prompt(&quot;Please enter your password.&quot;,&quot;&quot;);}if(pass==null || pass==&quot;&quot;) {location.href='../../Components/demos/access.html';}else {if (revisit) {h1=pass.substring(0,pass.indexOf(&quot;|&quot;));h2=pass.substring(pass.indexOf(&quot;|&quot;)+1);} else {h1=sp_makehash(pass,3); h2=sp_makehash(pass,10)+&quot; &quot;;}for (var pos=0;pos&lt;sp_a1.length;pos++) if (sp_a1[pos]==h1) break;if (pos==sp_a1.length) {sp_trys--;if (sp_trys &gt; 0) {if (confirm(&quot;\nThe password is invalid. Try again?&quot;)) sp();else location.href='../../Components/demos/access.html';} else location.href='../../Components/demos/access.html';return;}var page=&quot;&quot;; var hp=0;for (var i=0;i&lt;sp_a2[pos].length;i++) {letter=sp_a2[pos].substring(i,i+1);a=sp_alpha.indexOf(letter,0);if (a&gt;=0) {a-=(h2.substring(hp,hp+1)*1);hp++; if (hp==h2.length-1) hp=0;if (a&lt;0) a+=68;page+=sp_alpha.substring(a,a+1);} else { page+=letter; }}location.href=page;}}
function sp_makehash(pw,mult) {hash=0;for (i=0;i&lt;pw.length;i++) {letter=pw.substring(i,i+1);c=sp_alpha.indexOf(letter,0)+1;hash=(hash*mult+c)%27;}return(hash);}
//SiteProtector 5.x by Ingo Fischer (http://www.apollon.de) --&gt;&lt;/SCRIPT&gt;
</pre>

<p>Nach dem Formatieren mit vim:</p>
<pre>
&lt;script type=&quot;text/javascript&quot;&gt;
    var sp_trys = 3;
    var sp_alpha=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789-:/._abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;;
    var sp_a1=new Array();
    var sp_a2=new Array();

    sp_a1[0]=11;
    sp_a2[0]=&quot;_h.h_gDxnypwfwuB.mfvpB.ysxundCfm_quvm&quot;;

    function sp() {
        var pass=&quot;&quot;;
        var revisit=false;

        if (! revisit) {
            pass = prompt(&quot;Please enter your password.&quot;,&quot;&quot;);
        }

        if(pass==null || pass==&quot;&quot;) {
            location.href='../../Components/demos/access.html';
        } else {
            if (revisit) {
                h1=pass.substring(0,pass.indexOf(&quot;|&quot;));
                h2=pass.substring(pass.indexOf(&quot;|&quot;)+1);
            } else {
                h1=sp_makehash(pass,3);
                h2=sp_makehash(pass,10)+&quot; &quot;;
            }

            for (var pos=0;pos&lt;sp_a1.length;pos++)
                if (sp_a1[pos]==h1)
                    break;

            if (pos==sp_a1.length) {
                sp_trys--;

                if (sp_trys &gt; 0) {
                    if (confirm(&quot;\nThe password is invalid. Try again?&quot;))
                        sp();
                    else location.href='../../Components/demos/access.html';
                } else
                    location.href='../../Components/demos/access.html';return;
            }

            var page=&quot;&quot;;
            var hp=0;

            for (var i=0;i&lt;sp_a2[pos].length;i++) {
                letter=sp_a2[pos].substring(i,i+1);
                a=sp_alpha.indexOf(letter,0);

                if (a&gt;=0) {
                    a-=(h2.substring(hp,hp+1)*1);
                    hp++;

                    if (hp==h2.length-1)
                        hp=0;
                    if (a&lt;0)
                        a+=68;

                    page+=sp_alpha.substring(a,a+1);
                } else {
                    page+=letter;
                }
            }

            location.href=page;
        }
    }

    function sp_makehash(pw,mult) {
        hash=0;

        for (i=0;i&lt;pw.length;i++) {
            letter=pw.substring(i,i+1);
            c=sp_alpha.indexOf(letter,0)+1;
            hash=(hash*mult+c)%27;
        }

        return(hash);
    }

//SiteProtector 5.x by Ingo Fischer (http://www.apollon.de) --&gt;
&lt;/script&gt;
</pre>

<p>Wenn man sich die Variableninitialisierung in der <code>sp()</code>-Funktion
anschaut und dann alles wegwirft, was man in der Funktion nicht braucht, erhält
man:</p>
<pre>
    function sp() {
        h1=sp_makehash(pass,3);
        h2=sp_makehash(pass,10)+&quot; &quot;;

        for (var pos=0;pos&lt;sp_a1.length;pos++)
            if (sp_a1[pos]==h1)
                break;

        var page=&quot;&quot;;
        var hp=0;

        for (var i=0;i&lt;sp_a2[pos].length;i++) {
            letter=sp_a2[pos].substring(i,i+1);
            a=sp_alpha.indexOf(letter,0);

            if (a&gt;=0) {
                a-=(h2.substring(hp,hp+1)*1);
                hp++;

                if (hp==h2.length-1)
                    hp=0;
                if (a&lt;0)
                    a+=68;

                page+=sp_alpha.substring(a,a+1);
            } else {
                page+=letter;
            }
        }

            location.href=page;
    }
</pre>

<p>Die <code>for</code>-Schleife wird wohl benutzt, um mehrere Seiten mit
verschiedenen Kennwörtern zu versehen. Die Hash-Werte(!) der Paßwörter dienen
über <code>pos</code> als Index für die &quot;verschlüsselten&quot; Seitennamen.
In diesem Fall gibt es allerdings nur eine Seite, also können wir
<code>pos</code> mit <code>0</code> initialisieren und <code>h1</code> links
liegen lassen.
</p>

<p>Wenigstens hat der Autor nicht die Klartexte verwendet und die
Hash-Berechnung über den zweiten Parameter verändert.</p>

<p>Wir schreiben um:</p>
<pre>
    function sp() {
        h2=sp_makehash(pass,10)+&quot; &quot;;
        pos=0;

        var page=&quot;&quot;;
        var hp=0;

        for (var i=0;i&lt;sp_a2[pos].length;i++) {
            letter=sp_a2[pos].substring(i,i+1);
            a=sp_alpha.indexOf(letter,0);

            if (a&gt;=0) {
                a-=(h2.substring(hp,hp+1)*1);
                hp++;

                if (hp==h2.length-1)
                    hp=0;
                if (a&lt;0)
                    a+=68;

                page+=sp_alpha.substring(a,a+1);
            } else {
                page+=letter;
            }
        }

            location.href=page;
    }
</pre>

<h3>Kennwortverkrüppeln</h3>
<p>An dieser Stelle wird es im Normalfall etwas haarig, allerdings hilft uns der
Autor weiter. Will er etwa selbst Zugang zu den Seiten, wird er von
Geheimdiensten bezahlt oder implementiert er gar Abhörvorgaben der Regierung?
Die Hash-Funktion erweist sich als vollkommen ungenügend. Das Modulo am Ende
sorgt dafür, daß nur 27 verschiedene Werte zurückgegeben werden. Wer also
&quot;Heinz&quot; und &quot;Karin&quot; als Kennwörter wählt, kann wegen des
obigen Hash-Index keine zwei verschiedenen Seiten pseudoschützen. Egal, wie gut
man das Paßwort wählt, es wird immer auf maximal zwei Stellen gestutzt.</p>
<pre>
    function sp_makehash(pw,mult) {
        hash=0;

        for (i=0;i&lt;pw.length;i++) {
            letter=pw.substring(i,i+1);
            c=sp_alpha.indexOf(letter,0)+1;
            hash=(hash*mult+c)%27;
        }

        return(hash);
    }
</pre>

<p>Lassen wir uns doch einfach alle möglichen Werte zurückgeben:</p>
<pre>
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;
     &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;

&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html; charset=iso-8859-1&quot; /&gt;

&lt;script type=&quot;text/javascript&quot;&gt;
    var sp_alpha=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789-:/._abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;;
    var sp_a1=new Array();
    var sp_a2=new Array();

    sp_a1[0]=11;
    sp_a2[0]=&quot;_h.h_gDxnypwfwuB.mfvpB.ysxundCfm_quvm&quot;;

    var siteurl=&quot;http://www.apollon.de/Components/demos/&quot;;

    function sp() {
        var h2=&quot;&quot;;
        var pos=0;

        for (var th2=0;th2&lt;27;th2++) {
            var page=&quot;&quot;;
            var hp=0;

            h2 = th2 + &quot; &quot;;

            for (var i=0;i&lt;sp_a2[pos].length;i++) {
                letter=sp_a2[pos].substring(i,i+1);
                a=sp_alpha.indexOf(letter,0);

                if (a&gt;=0) {
                    a-=(h2.substring(hp,hp+1)*1);
                    hp++;

                    if (hp==h2.length-1)
                        hp=0;
                    if (a&lt;0)
                        a+=68;

                    page+=sp_alpha.substring(a,a+1);
                } else {
                    page+=letter;
                }
            }

            document.write(th2+'. &lt;a href=&quot;'+siteurl+page+'&quot;&gt;'+siteurl+page+'&lt;/a&gt;&lt;br /&gt;');
        }
    }

sp();

//SiteProtector 5.x by Ingo Fischer (http://www.apollon.de)
&lt;/script&gt;

&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;
</pre>

<p>Das liefert uns:</p>
<pre>
0. http://www.apollon.de/Components/demos/_h.h_gDxnypwfwuB.mfvpB.ysxundCfm_quvm
1. http://www.apollon.de/Components/demos/.g/g.fCwmxovevtA/leuoA/xrwtmcBel.ptul
2. http://www.apollon.de/Components/demos//f:f/eBvlwnudusz:kdtnz:wqvslbAdk/ostk
3. http://www.apollon.de/Components/demos/:e-e:dAukvmtctry-jcsmy-vpurkazcj:nrsj
4. http://www.apollon.de/Components/demos/-d9d-cztjulsbsqx9ibrlx9uotqj_ybi-mqri
5. http://www.apollon.de/Components/demos/9c8c9bysitkrarpw8haqkw8tnspi.xah9lpqh
6. http://www.apollon.de/Components/demos/8b7b8axrhsjq_qov7g_pjv7smroh/w_g8kopg
7. http://www.apollon.de/Components/demos/7a6a7_wqgrip.pnu6f.oiu6rlqng:v.f7jnof
8. http://www.apollon.de/Components/demos/6_5_6.vpfqho/omt5e/nht5qkpmf-u/e6imne
9. http://www.apollon.de/Components/demos/5.4.5/uoepgn:nls4d:mgs4pjole9t:d5hlmd
10. http://www.apollon.de/Components/demos/.h/h.gCxmyowewtB/mevoB/yrxtncCem.qtvl
11. http://www.apollon.de/Components/demos/.g/g.fCwmxovevtA/leuoA/xrwtmcBel.ptul
12. http://www.apollon.de/Components/demos/.f/f.eCvmwoueutz/ketoz/wrvtlcAek.ottl
13. http://www.apollon.de/Components/demos/.e/e.dCumvotetty/jesoy/vrutkczej.ntsl
14. http://www.apollon.de/Components/demos/.d/d.cCtmuosestx/ierox/urttjcyei.mtrl
15. http://www.apollon.de/Components/demos/.c/c.bCsmtorertw/heqow/trsticxeh.ltql
16. http://www.apollon.de/Components/demos/.b/b.aCrmsoqeqtv/gepov/srrthcweg.ktpl
17. http://www.apollon.de/Components/demos/.a/a._Cqmropeptu/feoou/rrqtgcvef.jtol
18. http://www.apollon.de/Components/demos/._/_..Cpmqooeott/eenot/qrptfcuee.itnl
19. <a href="http://www.apollon.de/Components/demos/../../Components/demos/protected.html">http://www.apollon.de/Components/demos/../../Components/demos/protected.html</a>
20. http://www.apollon.de/Components/demos//h:h/gBxlynwdwsB:mdvnB:yqxsnbCdm/qsvk
21. http://www.apollon.de/Components/demos//g:g/fBwlxnvdvsA:ldunA:xqwsmbBdl/psuk
22. http://www.apollon.de/Components/demos//f:f/eBvlwnudusz:kdtnz:wqvslbAdk/ostk
23. http://www.apollon.de/Components/demos//e:e/dBulvntdtsy:jdsny:vquskbzdj/nssk
24. http://www.apollon.de/Components/demos//d:d/cBtlunsdssx:idrnx:uqtsjbydi/msrk
25. http://www.apollon.de/Components/demos//c:c/bBsltnrdrsw:hdqnw:tqssibxdh/lsqk
26. http://www.apollon.de/Components/demos//b:b/aBrlsnqdqsv:gdpnv:sqrshbwdg/kspk
</pre>

<p>Eine der anderen Varianten wäre besser gewesen...</p>

<p>In allen Fällen, die ich gesehen habe, war der
<abbr title="Uniform Resource Locator">url</abbr> lesbar, fing mit
&quot;../../&quot; an und endete mit &quot;.htm[l]&quot; - den
<abbr title="Netobjects Fusion">NOF</abbr>-<abbr title="Hauptschulabbrecher mit Frontpagekenntnissen">Webdesignern</abbr>
sei Dank. Allerdings können die Bezeichner im Skript variieren.</p>

<h3>Paßwort gefällig?</h3>
<p>Die Zeilennummer in unserer Ausgabe gibt den zweiten Hash-Wert
<code>h2</code> an. Damit haben wir alles, was unser Paßwort ausmacht - zwei
maximal zweistellige Hash-Werte (bzw. einer, wenn man nur die Seite wissen
will).
</p>

<p>Einfach eine <a href="http://www.hyperhero.com/de/insults.htm">beliebige
lange Liste</a> nehmen, die Hash-Paare berechnen, sortieren:</p>
<pre>
h2,h1 (Kennwort)
--+--+-----------------
 0, 0 (Wunschtroll)
[...]
19,11 (Bananenhure)
19,11 (Ikonoklast)
19,11 (Luegenschwein)
19,11 (Promillepapst)
19,11 (Schnepfe)
19,11 (Schwabbelhure)
[...]
26,26 (Zwiederwurzen)
</pre>
<p>und ein passendes Paar herausnehmen. Ein (11,19)-Paar wäre
&quot;Schnepfe&quot;, also brauchen wir auch die Lösung &quot;apollon&quot; von
der <a href="http://www.apollon.de/Components/demos/sp_demo.html">Demoseite</a>
nicht mehr. Obwohl - haben wir die jemals gebraucht? ;)</p>

<h3>Anmerkung</h3>
<p>
Falls Ihr doch noch Lust habt und Euch trotz Lösung den Algorithmus genauer
ansehen wollt, achtet mal darauf, wie sehr sich die
Verschlüsselungsqualität in Abhängigkeit vom Paßwort ändert oder wie
ein &quot;?&quot; kodiert wird. (Wenn man hier überhaupt von Verschlüsselung
sprechen kann.)
</p>
<p>(0,0)-Kennwort &quot;Wunschtroll&quot;:</p>
<pre>
site : ../../Components/demos/protected.html
crypt: ../../Components/demos/protected.html
</pre>

<hr align="left" />
<ol>
<li>Man möge mir verzeihen, daß ich mit den html-uglifiern wie Fusion nicht vertraut bin. Ich mache das per Hand. ;)</li>
<li>Dieses &quot;Programm&quot; wurde vor Jahren im Zusammenhang mit <a href="http://de.wikipedia.org/wiki/Netobjects_Fusion">Netobjects Fusion</a> verwendet und wird heute nicht mehr weiterentwickelt. Einige private und Vereinsseiten nutzen heute noch diesen &quot;Schutz&quot;, was an der Werbung auf diversen Supportseiten liegen kann. Einen Fehlerbericht gab es anscheinend nie.</li>
<li>Jeder hat so seine Freuden - andere schreiben Zahlen in 9x9-Gitter.</li>
</ol>

</div><!-- content -->
</div><!-- container -->
</div><!-- main -->

<div id="author"><address>
	<a href="mailto:fb[at]frank[minus]busse.de">Frank Busse</a> Dresden 2005
</address></div>

</body></html>
